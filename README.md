# Система учёта работников компании

## Как развернуть проект
- Создайте файл .env по примеру файла .env.example
- Создайте виртуальное окружение и установите зависимости, выполнив команду
```
poetry install --no-root
```
- Находясь в корневой директории примените миграции для создания базы данных, выполнив команду
```
poetry run python src/manage.py migrate
```
- Заполните базу данных начальными данными (должности, сотрудники), выполнив команду
```
poetry run python src/manage.py load_initial_data
```
- Запустите проект, выполнив команду
```
poetry run python src/manage.py runserver
```
## Доступные эндпоинты
Все доступные эндпоинты можно посмотреть по ссылке http://127.0.0.1:8000/api/redoc/ 

## Права доступа
Базовый функционал (получение списка сотрудников, получение подробной информации о сотруднике) доступны любым пользователям.
Для доступа к CRUD эндпоинтам необходимо иметь права доступа админ

## Как создать пользователя
Находясь в корневой директории выполните команду
```
poetry run python src/manage.py createsuperuser
```
Далее следуйте инструкциям в терминале

## Как получить токен
Направьте post запрос с username и password пользователя на эндпоинт http://127.0.0.1:8000/api/token/login

Как использовать токен.
Добавьте в headers запроса поле Authorization с вашим токеном, добавив Token перед полученным токеном (Token f62d7abf7797c00d9fdb03a5e021040e89471354)

## Как запустить тесты
Находясь в корневой директории выполните команду
```
poetry run pytest
```

## Как протестировать импорт данных
В папке data находятся файлы эксель для тестирования:
- valid_data.xlsx содержит валидные данные для загрузки, должны быть созданы все записи
- invalid_data.xlsx содержит невалидные данные для загрузки, часть записей создастся, часть нет, вернутся ошибки валидации
- pattern.xlsx содержит шаблон файла для самостоятельного заполнения

Направьте post запрос с прикрепленным файлом на эндпоинт http://127.0.0.1:8000/api/workers/import/

